/* empty css             */import{v as X}from"./loading-768be197.js";/* empty css               */import{E as Y}from"./input-number-56113039.js";/* empty css              */import{E as q,a as J}from"./breadcrumb-item-ab243313.js";import{$ as j,_ as P,x as Q,h,a3 as D,r as K,a1 as w,o as u,c as r,a as e,t as _,F as k,l as S,m as W,w as y,I as x,p as G,g as F,i as Z,j as ee,N as M,b as V,Q as B,J as L,a7 as se,k as te,d as f,n as oe,f as T,e as b}from"./index-6ff172c9.js";import{E as le}from"./index-1ce73683.js";import"./index-28a8381a.js";import"./event-ada0a21c.js";import"./error-78e43d3e.js";const ae=t=>j({url:"/goods",params:{id:t}}),ne=({id:t,type:l,limit:s=3})=>j({url:"/goods/hot",params:{id:t,type:l,limit:s}});const z=t=>(G("data-v-8501a2b2"),t=t(),F(),t),ce={class:"goods-hot"},ie=z(()=>e("div",{style:{height:"15px","background-color":"#fff"}},null,-1)),de={alt:""},ue={class:"name ellipsis"},re={class:"desc ellipsis"},_e={class:"price"},pe=z(()=>e("div",{style:{height:"15px","background-color":"#fff"}},null,-1)),ve=z(()=>e("div",{style:{height:"30px"}},null,-1)),me={__name:"Hot-index",props:{type:{type:Number,default:1}},setup(t){const l=t,s={1:"24小时热榜",2:"周热榜"},a=Q(()=>s[l.type]),n=h([]),o=D();return(async()=>{const i=await ne({id:o.params.id,type:l.type});n.value=i.result})(),(i,d)=>{const p=K("RouterLink"),v=w("img-lazy");return u(),r("div",ce,[e("h3",null,_(a.value),1),ie,(u(!0),r(k,null,S(n.value,m=>(u(),W(p,{to:`/product/${m.id}`,class:"goods-item",key:m.id},{default:y(()=>[x(e("img",de,null,512),[[v,m.picture]]),e("p",ue,_(m.name),1),e("p",re,_(m.desc),1),e("p",_e,"¥"+_(m.price),1)]),_:2},1032,["to"]))),128)),pe,ve])}}},H=P(me,[["__scopeId","data-v-8501a2b2"]]);const ge={class:"goods-image"},fe=["src"],he={class:"small"},ye=["onMouseenter"],be={alt:""},ke={__name:"Image-index",props:{imageList:{type:Array,required:!0}},setup(t){const l=h(0),s=h(null),{elementX:a,elementY:n,isOutside:o}=Z(s),c=h(0),i=h(0),d=h(0),p=h(0);return ee([a,n,o],()=>{o.value||(a.value>100&&a.value<300&&(c.value=a.value-100),n.value>100&&n.value<300&&(i.value=n.value-100),a.value>300&&(c.value=200),a.value<100&&(c.value=0),n.value>300&&(i.value=200),n.value<100&&(i.value=0),d.value=-c.value*2,p.value=-i.value*2)}),(v,m)=>{const I=w("img-lazy");return u(),r("div",ge,[e("div",{class:"middle",ref_key:"target",ref:s},[e("img",{src:t.imageList[l.value],alt:"",loading:"lazy"},null,8,fe),x(e("div",{class:"layer",style:B({left:`${c.value}px`,top:`${i.value}px`})},null,4),[[M,!V(o)]])],512),e("ul",he,[(u(!0),r(k,null,S(t.imageList,(C,E)=>(u(),r("li",{key:E,onMouseenter:A=>l.value=E,class:L({active:E===l.value})},[x(e("img",be,null,512),[[I,C]])],42,ye))),128))]),x(e("div",{class:"large",style:B([{backgroundImage:`url(${t.imageList[l.value]})`,backgroundPositionX:`${d.value}px`,backgroundPositionY:`${p.value}px`}])},null,4),[[M,!V(o)]])])}}},xe=P(ke,[["__scopeId","data-v-dedb7b28"]]);function $e(t){const l=[],s=2**t.length;for(let a=0;a<s;a+=1){const n=[];for(let o=0;o<t.length;o+=1)a&1<<o&&n.push(t[o]);l.push(n)}return l}const N="★",Ie=t=>{const l={};return t&&t.length>0&&t.forEach(s=>{if(s.inventory){const a=s.specs.map(o=>o.valueName);$e(a).forEach(o=>{const c=o.join(N);l[c]||(l[c]=[]),l[c].push(s.id)})}}),l};function Se(t,l){t&&t.length>0&&t.forEach(s=>{s.values.forEach(a=>{a.disabled=!l[a.name]})})}const O=t=>{const l=[];return t.forEach((s,a)=>{const n=s.values.find(o=>o.selected);n?l[a]=n.name:l[a]=void 0}),l},Ee=(t,l)=>{t.forEach((s,a)=>{const n=O(t);s.values.forEach(o=>{if(!o.selected){n[a]=o.name;const c=n.filter(i=>i).join(N);o.disabled=!l[c]}})})},Pe={name:"GoodSku",props:{goods:{type:Object,default:()=>({specs:[],skus:[]})}},emits:["change"],setup(t,{emit:l}){let s={};return se(()=>{s=Ie(t.goods.skus),Se(t.goods.specs,s)}),{clickSpecs:(n,o)=>{if(o.disabled)return!1;o.selected?o.selected=!1:(n.values.forEach(i=>{i.selected=!1}),o.selected=!0),Ee(t.goods.specs,s);const c=O(t.goods.specs).filter(i=>i);if(c.length===t.goods.specs.length){const i=s[c.join(N)][0],d=t.goods.skus.find(p=>p.id===i);l("change",{skuId:d.id,price:d.price,oldPrice:d.oldPrice,inventory:d.inventory,specsText:d.specs.reduce((p,v)=>`${p} ${v.name}：${v.valueName}`,"").trim()})}else l("change",{})}}}},we={class:"goods-sku"},Ce=["onClick","title"],Le=["onClick"];function ze(t,l,s,a,n,o){const c=w("img-lazy");return u(),r("div",we,[(u(!0),r(k,null,S(s.goods.specs,i=>(u(),r("dl",{key:i.id},[e("dt",null,_(i.name),1),e("dd",null,[(u(!0),r(k,null,S(i.values,d=>(u(),r(k,{key:d.name},[d.picture?x((u(),r("img",{key:0,class:L({selected:d.selected,disabled:d.disabled}),onClick:p=>a.clickSpecs(i,d),title:d.name},null,10,Ce)),[[c,d.picture]]):(u(),r("span",{key:1,class:L({selected:d.selected,disabled:d.disabled}),onClick:p=>a.clickSpecs(i,d)},_(d.name),11,Le))],64))),128))])]))),128))])}const Ne=P(Pe,[["render",ze],["__scopeId","data-v-5c652d9a"]]);const $=t=>(G("data-v-5d7eab3f"),t=t(),F(),t),Ae={class:"goods-page"},Me={key:0,class:"container"},Ve={class:"bread-container"},Be={class:"goods-info"},Te={class:"media"},He={class:"goods-sales"},je=$(()=>e("p",null,"销量",-1)),De={style:{"font-weight":"600"}},Ge=$(()=>e("p",{style:{cursor:"default"}},[e("i",{class:"iconfont icon-task-filling"}),b("爆品尖货")],-1)),Fe=$(()=>e("p",null,"折扣",-1)),Oe={style:{"font-weight":"600"}},Re=$(()=>e("p",{style:{cursor:"default"}},[e("i",{class:"iconfont icon-favorite-filling"}),b("大额优惠 ")],-1)),Ue={class:"spec"},Xe={class:"g-name"},Ye={class:"g-desc"},qe={class:"g-price"},Je=$(()=>e("div",{class:"g-service"},[e("dl",null,[e("dt",null,"促销"),e("dd",null,"12月好物放送，最高直降1000元")]),e("dl",null,[e("dt",null,"服务"),e("dd",null,[e("span",null,"七天无理由退货"),e("span",null,"专人售后"),e("span",null,"运费险")])])],-1)),Qe=$(()=>e("span",{style:{color:"#999",display:"inline-block",width:"50px","margin-left":"10px"}},"数量",-1)),Ke={class:"goods-footer"},We={class:"goods-article"},Ze={class:"goods-tabs"},es=$(()=>e("nav",null,[e("a",null,"商品详情")],-1)),ss={class:"goods-detail"},ts={class:"attrs"},os={class:"dt"},ls={class:"dd"},as={class:"goods-aside"},ns={__name:"Product-index",setup(t){const l=te(),s=h({}),a=D(),n=h(!0),o=h(1);let c={};(async()=>{try{const v=await ae(a.params.id);s.value=v.result}catch{}n.value=!1})();const d=v=>{c=v,c.skuId&&(s.value.oldPrice=v.oldPrice,s.value.price=v.price)},p=()=>{c.skuId?(l.add_item({id:s.value.id,name:s.value.name,picture:s.value.mainPictures[0],price:s.value.price,count:o.value,skuId:c.skuId,attrsText:c.specsText,selected:!0}),T.success("已加入购物车")):T.warning("请选择商品规格")};return(v,m)=>{const I=J,C=q,E=Y,A=le,R=w("img-lazy"),U=X;return x((u(),r("div",Ae,[s.value.details?(u(),r("div",Me,[e("div",Ve,[f(C,{separator:">"},{default:y(()=>[f(I,null,{default:y(()=>[b("首页")]),_:1}),f(I,null,{default:y(()=>[b(_(s.value.categories[1].name),1)]),_:1}),f(I,{to:{path:`/category/sub/${s.value.categories[0].id}`}},{default:y(()=>[b(_(s.value.categories[0].name),1)]),_:1},8,["to"]),f(I,null,{default:y(()=>[b(_(s.value.name),1)]),_:1})]),_:1})]),e("div",null,[e("div",null,[e("div",Be,[e("div",Te,[f(xe,{imageList:s.value.mainPictures.filter(g=>g)},null,8,["imageList"]),e("ul",He,[e("li",null,[je,e("p",De,_(s.value.salesCount)+"+",1),Ge]),e("li",null,[Fe,e("p",Oe,_(s.value.discount==1?"- 暂无 -":`${(s.value.discount*10).toFixed(1)}折`),1),Re])])]),e("div",Ue,[e("p",Xe,_(s.value.name),1),e("p",Ye,_(s.value.desc),1),e("p",qe,[e("span",null,"￥"+_(s.value.price),1),e("span",null,_(s.value.discount==1?"":"￥"+s.value.oldPrice),1)]),Je,f(Ne,{goods:s.value,onChange:d},null,8,["goods"]),Qe,f(E,{modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=g=>o.value=g),min:1,onChange:m[1]||(m[1]=g=>o.value=g),size:"small"},null,8,["modelValue"]),e("div",null,[f(A,{type:"primary",size:"large",class:"btn",onClick:p},{default:y(()=>[b(" 加入购物车 ")]),_:1})])])]),e("div",Ke,[e("div",We,[e("div",Ze,[es,e("div",ss,[e("ul",ts,[(u(!0),r(k,null,S(s.value.details.properties,g=>(u(),r("li",{key:g.value},[e("span",os,_(g.name),1),e("span",ls,_(g.value),1)]))),128))]),(u(!0),r(k,null,S(s.value.details.pictures,g=>x((u(),r("img",{key:g,alt:""})),[[R,g]])),128))])])]),e("div",as,[f(H,{type:1}),f(H,{type:2})])])])])])):oe("",!0)])),[[U,n.value,void 0,{fullscreen:!0,lock:!0}]])}}},hs=P(ns,[["__scopeId","data-v-5d7eab3f"]]);export{hs as default};
